
    <script src="http://www.kineticjs.com/download/kinetic-v3.9.4.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js" type="text/javascript"></script>
    <script src="http://jashkenas.github.com/coffee-script/extras/coffee-script.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/coffeescript">
        $ ->
            stage = new Kinetic.Stage
                container: "map"
                width: 800
                height: 600
            vsep = 120 * Math.cos(Math.PI/6)
            hexLayer = new Kinetic.Layer
                draggable: true
                dragBounds:
                    top: -vsep*21+stage.getHeight()
                    bottom: 0 
                    right: 0
                    left: -120*3/4*21+stage.getWidth()
            for x in [1..20]
                for y in [1..20]
                    text = new Kinetic.Text
                        text: "#{x}, #{y}"
                        x: x*120*3/4
                        y: (if x%2 == 1 then y*vsep else (y+0.5)*vsep)+(vsep/2-10)
                        textFill: 'black'
                        align: 'center'
                        verticalAlign: 'middle'
                    hex = new Kinetic.RegularPolygon
                        x: x*120*3/4
                        y: if x%2 == 1 then y*vsep else (y+0.5)*vsep
                        sides: 6
                        radius: 60
                        stroke: 'black'
                        fill: 'white'
                        rotation: Math.PI/2
                    hex.on('mouseover', -> 
                        @setStroke('blue')
                        hex.draw())
                    hex.on('mouseout', ->
                        @setStroke('black')
                        hex.draw())
                    hexLayer.add(hex)
                    hexLayer.add(text)
            stage.add(hexLayer)
    </script>
</head>
<body>
    <div id="map"></div>
</body>
</html>
